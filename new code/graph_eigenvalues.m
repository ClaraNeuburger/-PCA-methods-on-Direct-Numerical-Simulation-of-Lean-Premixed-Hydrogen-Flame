errors = [ 0.0093
0.0077
2.7849e-06
1.4566e-05
0.0090
0.0058];

eigval =[9
6
1
1
7
6];

error_out =[ 0.6002
0.2570
0.1620
0.1029
0.0659
0.0367
0.0219
0.0134
0.0091];

error_normal=[0.6103
0.3223
0.1468
0.0956
0.0575
0.0356
0.0196
0.0196
0.0093];

error_norm=[0.6103
0.3223
0.1468
0.0956
0.0575
0.0356
0.0196
0.0196
0.0093
0.0061
0.0038
0.0023
9.37E-04
4.28E-04
2.32E-04
1.22E-04
4.11E-05
1.12E-05
9.09E-07
6.49E-08
0];

q_2 =[1.875685e+00 
1.168765e+00 
9.979324e-01
];

PC_normal = [8.0962540884790393e+00
   5.9830703413735318e+00
   3.6468490647184941e+00
   1.0643222388381623e+00
   7.8996406192755719e-01
   4.5502188135119759e-01
   3.3207913693061575e-01
   1.1319387234693641e-01
   1.0082795258264222e-01
   6.8196628934606401e-02
   4.7026801704873090e-02
   3.1375121278238369e-02
   2.8019178652347886e-02
   1.0585514690225188e-02
   4.0586800522159176e-03
   2.3030252248337686e-03
   1.6713399839989936e-03
   6.2130018799869612e-04
   2.1311433824358896e-04
   1.7531067238594004e-05
   1.3487544244020649e-06];

PC_outlier = [   8.3598464022770003e+00
   7.1742566953204436e+00
   1.9867930438047245e+00
   1.2368267010364671e+00
   7.7319240656470045e-01
   6.0994685187584674e-01
   3.0947297963031795e-01
   1.7692935698797990e-01
   9.1067129247936585e-02
   7.7102165135873396e-02
   3.9301537911813775e-02
   3.1018116479363093e-02
   2.4187236525095766e-02
   8.0540686376637926e-03
   4.7070420511649644e-03
   3.0563243837731821e-03
   1.8409341428973580e-03
   4.9379756334826119e-04
   1.9553643117764248e-04
   1.2337657717105416e-04
   5.2370662698973761e-06];

PC_log = [   8.1000675305752168e+00
   5.9614929050278960e+00
   3.6589403359279760e+00
   1.0652516941570949e+00
   7.9023365213531382e-01
   4.5558364326159501e-01
   3.3203890735333452e-01
   1.1463364043455213e-01
   1.0095467475340734e-01
   6.9580528246900600e-02
   4.6915237270989160e-02
   3.1436904150458349e-02
   2.9174712978397292e-02
   1.0507937187434582e-02
   4.0638534634936541e-03
   2.3016983443263127e-03
   1.5387002000771077e-03
   6.2493037195260467e-04
   2.1848798127686444e-04
   1.2326410023129022e-04
   1.4362394344010500e-06];

PC_sqrt = [   9.9036715348928457e+00
   6.2340743072878908e+00
   3.0272580006514556e+00
   7.6179328091619825e-01
   5.5237369816870396e-01
   2.2122853474670021e-01
   1.4310508547758130e-01
   6.2759952685551942e-02
   4.3472242548122632e-02
   1.9948148825298377e-02
   1.0038217925647745e-02
   9.4553546764907393e-03
   4.9283291057311820e-03
   2.3564868167046814e-03
   1.5692869736608241e-03
   7.2116476111535720e-04
   5.7448648541368053e-04
   4.5884274403644817e-04
   1.6622927746950787e-04
   2.9960347201115275e-05
   1.6828519721484215e-05];

%figure
%hold on
%set(gcf,'color','w')
%box on
%plot(error_normal,'r')
%plot(error_out,'b')
%ylabel('Relative lack of fit');
%xlabel('Number of eigenvalues preserved')
%legend('With outliers','Without outliers')
%hold off

t = tiledlayout(1,3);
nexttile
set(gcf,'color','w')
box on
plot(PC_normal,'-bo')
ylabel('Eigenvalues Magnitude');
xlabel('Component index')
title('PCs without transformation')

nexttile
set(gcf,'color','w')
box on
plot(PC_log,'-bo')
ylabel('Eigenvalues Magnitude');
xlabel('Component index')
title('PCs with log transformation')

nexttile
set(gcf,'color','w')
box on
plot(PC_sqrt,'-bo')
ylabel('Eigenvalues Magnitude');
xlabel('Component index')
title('PCs with sqrt transformation')

%plot(error_norm,'r')
%hold on
%plot(error_out,'b')
%hold off
%legend('With outliers','Without outliers')
%X = categorical({'auto','range','pareto','vast','level','max'});
%X = reordercats(X,{'auto','range','pareto','vast','level','max'});
%bar(X,errors)
%names = {'auto','range','pareto','vast','level','max'};

%bar(X,eigval)
%bar(errors)
%set(gca,'yticklabel',names)



